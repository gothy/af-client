{"version":3,"sources":["../../src/index.js"],"names":[],"mappings":"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","file":"src/index.js","sourcesContent":["var protocol = window.location.href.split('://')[0];\nif (protocol === 'file') { protocol = 'http'; }\n\nvar base_url = `${protocol}://alfafile.net/api/v1`;\n\nvar token = '';\n\nconst UPL_STATE_UPLOADING = 0;\nconst UPL_STATE_PROCESSING = 1;\nconst UPL_STATE_DONE = 2;\nconst UPL_STATE_FAIL = 3;\n\nclass ApiError extends Error {\n  constructor(message) {\n    super();\n    this.name = 'ApiError';\n    this.message = message;\n  }\n}\n\nclass NetworkError extends Error {\n  constructor(message) {\n    super();\n    this.name = 'NetworkError';\n    this.message = message;\n  }\n}\n\n\nvar _doCheckUploadState = function(params, upload_id, cb) {\n  params.token = params.token || token;\n\n  let params_str = 'upload_id=' + (encodeURIComponent(upload_id));\n  params_str += '&token=' + (encodeURIComponent(params.token));\n\n  var check_int = setInterval(() => {\n    let xhr = new XMLHttpRequest();\n    xhr.open('GET', `${base_url}/file/upload_info?${params_str}`, true);\n    xhr.onreadystatechange = function() {\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        let data = JSON.parse(xhr.responseText);\n        if (data.response.upload.state !== UPL_STATE_PROCESSING) {\n          if (cb && typeof cb === 'function') {\n            clearInterval(check_int);\n            return cb(null, data.response.upload);\n          }\n        }\n      } else if (xhr.readyState === 4 && xhr.status !== 200) {\n        if (cb && typeof cb === 'function') {\n          return cb(new NetworkError('NetworkError'));\n        }\n      }\n    };\n    xhr.send();\n  }, 1000);\n};\n\nvar _doFileUpload = function(params, upload_url, cb) {\n  let form_data = new FormData();\n  \n  form_data.append('file', params.file);\n  form_data.append('token', params.token || token);\n\n  let upload_progress = function(event) {\n    if (event.lengthComputable) {\n      if (params.progress_cb && typeof params.progress_cb === 'function') {\n        return params.progress_cb(Math.ceil(event.loaded / event.total * 100));\n      }\n    }\n  };\n\n  let xhr = new XMLHttpRequest();\n  xhr.open('POST', upload_url, true);\n  xhr.upload.onprogress = upload_progress;\n  if (params.abort_cb && typeof params.abort_cb === 'function') {\n    xhr.onabort = params.abort_cb;\n  }\n\n  xhr.onreadystatechange = function() {\n    var data, response;\n    if (xhr.readyState === 4 && xhr.status === 200) {\n      data = JSON.parse(xhr.responseText);\n      response = data.response;\n      if (data.status === 200) {\n        return _doCheckUploadState(params, response.upload.upload_id, cb);\n      } else {\n        if (cb && typeof cb === 'function') {\n          return cb(new ApiError('' + (data ? data.details : '')));\n        }\n      }\n    } else if (xhr.readyState === 4 && xhr.status !== 200) {\n      if (cb && typeof cb === 'function') {\n        return cb(new NetworkError('Network error'));\n      }\n    }\n  };\n\n  xhr.send(form_data);\n\n  if (params.upload_xhr_available && typeof params.upload_xhr_available === 'function') {\n    return params.upload_xhr_available(xhr);\n  }\n};\n\nvar _itemMethodHelper = function(itype, method, params, response_field, cb) {\n  params = params || {};\n  params.token = params.token || token;\n\n  let params_str = '';\n  Object.keys(params).forEach(key => {\n    let val = params[key];\n    if (typeof val !== 'function') {\n      params_str += `${key}=${encodeURIComponent(val)}&`;\n    }\n  });\n\n  let xhr = new XMLHttpRequest();\n  xhr.open('GET', `${base_url}/${itype}/${method}?${params_str}`, true);\n  xhr.onreadystatechange = function() {\n    if (xhr.readyState === 4 && xhr.status === 200) {\n      let data = JSON.parse(xhr.responseText);\n\n      if (data.status === 200 && data.response) {\n        // return the default result or a special field?\n        let result = response_field ? data.response[response_field] : data.response;\n\n        // two-level method or not?\n        let twolevel = false;\n\n        if (itype === 'user' && method === 'login') {\n          token = data.response.token; // set global token on login\n        } else if (itype === 'file' && method === 'upload') { // file upload method\n          let up_state = data.response.upload.state;\n          if (up_state === UPL_STATE_UPLOADING) {\n            twolevel = true; // it's a two-level operation\n            _doFileUpload(params, data.response.upload.url, cb);\n          }\n        }\n        // by default: call passed callback with a response result\n        if (cb && typeof cb === 'function' && !twolevel) {\n          cb(null, result);\n        }\n      } else {\n        // once the response status in not 200, we should pass an ApiError to callback\n        if (cb && typeof cb === 'function') {\n          cb(new ApiError('' + (data ? data.details : '')));\n        }\n      }\n    } else if (xhr.readyState === 4 && xhr.status === 200) {\n      if (cb && typeof cb === 'function') {\n        cb(new NetworkError('Network error'));\n      }\n    }\n  };\n\n  xhr.send();\n};\n\nvar userLogin = function(login, password, cb) {\n  return _itemMethodHelper('user', 'login', {\n    login: login,\n    password: password\n  }, 'user', cb);\n};\n\nvar userInfo = function(cb) {\n  return _itemMethodHelper('user', 'info', {}, 'user', cb);\n};\n\nvar fileUpload = function(name, hash, size, file, options, cb) {\n  let args = Array.prototype.slice.call(arguments), \n      params = {};\n  cb = args.pop();\n\n  if (args.length === 5) {\n    params = options;\n  }\n\n  params.name = name;\n  params.hash = hash;\n  params.size = size;\n  params.file = file;\n\n  return _itemMethodHelper('file', 'upload', params, 'upload', cb);\n};\n\nvar fileRename = function(file_id, name, cb) {\n  let params = {\n    file_id: file_id,\n    name: name\n  };\n  return _itemMethodHelper('file', 'rename', params, 'file', cb);\n};\n\nvar fileDelete = function(file_id, cb) {\n  let params = {\n    file_id: file_id\n  };\n  return _itemMethodHelper('file', 'delete', params, 'result', cb);\n};\n\nvar fileCopy = function(file_id, folder_id_dest, cb) {\n  let params = {\n    file_id: file_id,\n    folder_id_dest: folder_id_dest\n  };\n  return _itemMethodHelper('file', 'copy', params, 'result', cb);\n};\n\nvar fileMove = function(file_id, folder_id_dest, cb) {\n  let params = {\n    file_id: file_id,\n    folder_id_dest: folder_id_dest\n  };\n  return _itemMethodHelper('file', 'move', params, 'result', cb);\n};\n\nvar fileChangeMode = function(file_id, mode, cb) {\n  let params = {\n    file_id: file_id,\n    mode: mode\n  };\n  return _itemMethodHelper('file', 'change_mode', params, 'file', cb);\n};\n\nvar folderInfo = function(options, cb) {\n  let args = Array.prototype.slice.call(arguments),\n      params = {};\n  cb = args.pop();\n  if (args.length === 1) {\n    params = options;\n  }\n\n  return _itemMethodHelper('folder', 'info', params, 'folder', cb);\n};\n\nvar folderContent = function(options, cb) {\n  let args = Array.prototype.slice.call(arguments),\n      params = {};\n  cb = args.pop();\n  if (args.length === 1) {\n    params = options;\n  }\n\n  return _itemMethodHelper('folder', 'content', params, 'folder', cb);\n};\n\nvar folderCreate = function(name, options, cb) {\n  let args = Array.prototype.slice.call(arguments), \n      params = {name: name};\n  \n  cb = args.pop();\n  if (args.length === 2) {\n    Object.keys(options).forEach(key => {\n      params[key] = options[key];\n    });\n  }\n\n  return _itemMethodHelper('folder', 'create', params, 'folder', cb);\n};\n\nvar folderRename = function(folder_id, name, cb) {\n  var params = {\n    name: name,\n    folder_id: folder_id\n  };\n\n  return _itemMethodHelper('folder', 'rename', params, 'folder', cb);\n};\n\nvar folderDelete = function(folder_id, cb) {\n  var params = {\n    folder_id: folder_id\n  };\n\n  return _itemMethodHelper('folder', 'delete', params, 'result', cb);\n};\n\nvar folderCopy = function(folder_id, folder_id_dest, cb) {\n  var params = {\n    folder_id: folder_id,\n    folder_id_dest: folder_id_dest\n  };\n\n  return _itemMethodHelper('folder', 'copy', params, 'result', cb);\n};\n\nvar folderMove = function(folder_id, folder_id_dest, cb) {\n  var params = {\n    folder_id: folder_id,\n    folder_id_dest: folder_id_dest\n  };\n\n  return _itemMethodHelper('folder', 'move', params, 'result', cb);\n};\n\nvar folderChangeMode = function(folder_id, mode, cb) {\n  var params = {\n    folder_id: folder_id,\n    mode: mode\n  };\n\n  return _itemMethodHelper('folder', 'change_mode', params, 'folder', cb);\n};\n\nvar trashcanContent = function(cb) {\n  return _itemMethodHelper('trashcan', 'content', {}, null, cb);\n};\n\nvar trashcanEmpty = function(options, cb) {\n  let args = Array.prototype.slice.call(arguments), \n      params = {};\n\n  cb = args.pop();\n  if (args.length === 1) {\n    params = options;\n  }\n\n  return _itemMethodHelper('trashcan', 'empty', params, 'result', cb);\n};\n\nvar trashcanRestore = function(options, cb) {\n  let args = Array.prototype.slice.call(arguments), \n      params = {};\n\n  cb = args.pop();\n  if (args.length === 1) {\n    params = options;\n  }\n\n  return _itemMethodHelper('trashcan', 'restore', params, 'result', cb);\n};\n\nvar remoteCreate = function(url, options, cb) {\n  let args = Array.prototype.slice.call(arguments), \n      params = {};\n\n  cb = args.pop();\n  if (args.length === 2) {\n    params = options;\n  }\n  params.url = url;\n\n  return _itemMethodHelper('remote', 'create', params, '', cb);\n};\n\nvar remoteDelete = function(job_id, cb) {\n  var params = {\n    job_id: job_id\n  };\n\n  return _itemMethodHelper('remote', 'delete', params, 'result', cb);\n};\n\nvar remoteInfo = function(options, cb) {\n  let args = Array.prototype.slice.call(arguments), \n      params = {};\n\n  cb = args.pop();\n  if (args.length === 1) {\n    params = options;\n  }\n\n  return _itemMethodHelper('remote', 'info', params, '', cb);\n};\n\nvar onetimeCreate = function(file_id, options, cb) {\n  let args = Array.prototype.slice.call(arguments), \n      params = {};\n\n  cb = args.pop();\n  if (args.length === 2) {\n    params = options;\n  }\n  params.file_id = file_id;\n\n  return _itemMethodHelper('one_time_download', 'create', params, 'download', cb);\n};\n\nvar onetimeInfo = function(options, cb) {\n  let args = Array.prototype.slice.call(arguments), \n      params = {};\n  cb = args.pop();\n  if (args.length === 1) {\n    params = options;\n  }\n\n  return _itemMethodHelper('one_time_download', 'info', params, '', cb);\n};\n\n\n// this is the entry point for your library\nvar AFClient = {\n  _setToken: function(newToken) {\n    token = newToken;\n  },\n  _setBaseUrl: function(newBaseUrl) {\n    base_url = newBaseUrl;\n  },\n  ApiError: ApiError,\n  NetworkError: NetworkError,\n  userLogin: userLogin,\n  userInfo: userInfo,\n  fileUpload: fileUpload,\n  fileRename: fileRename,\n  fileDelete: fileDelete,\n  fileMove: fileMove,\n  fileCopy: fileCopy,\n  fileChangeMode: fileChangeMode,\n  folderInfo: folderInfo,\n  folderContent: folderContent,\n  folderCreate: folderCreate,\n  folderRename: folderRename,\n  folderDelete: folderDelete,\n  folderCopy: folderCopy,\n  folderMove: folderMove,\n  folderChangeMode: folderChangeMode,\n  trashcanContent: trashcanContent,\n  trashcanEmpty: trashcanEmpty,\n  trashcanRestore: trashcanRestore,\n  remoteCreate: remoteCreate,\n  remoteDelete: remoteDelete,\n  remoteInfo: remoteInfo,\n  onetimeCreate: onetimeCreate,\n  onetimeInfo: onetimeInfo,\n\n  promised: {}\n};\n\nlet except = ['_setToken', '_setBaseUrl', 'ApiError', 'NetworkError'];\nObject.keys(AFClient).forEach(key => {\n  let method = AFClient[key];\n  // check if it's an API method\n  if (except.indexOf(key) >= 0 || typeof method !== 'function') {\n    return;\n  }\n\n  AFClient.promised[key] = function() {\n    let args = Array.prototype.slice.call(arguments);\n    return new Promise((resolve, reject) => {\n      let cb = function (err, result) {\n        if (err) { reject(err); } else { resolve(result); }\n      };\n      args.push(cb);\n\n      AFClient[key].apply(null, args);\n    });\n  }\n});\n\nexport default AFClient\n"]}